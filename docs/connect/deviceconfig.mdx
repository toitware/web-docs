---
order: 3
---

import { Link } from "gatsby";

# Configure a device

When you have installed the Toit firmware on your device, the following two default configurations are present:

- The value of 'Max offline' for the device is 0 seconds, which means that the device is continuously awake.

- The firmware version on the device is the one installed during initial <Link to="../connect/provision">device provisioning</Link>.

How to change each device configuration available is explained below. Changes are applied once the device comes online.

=== "Console"
To change the device configurations, navigate to the **Configuration** tab for a given device and edit the sections as described below.

=== "CLI"
To change the device configurations, use the Toit CLI:

    ```
    toit device config <command>
    ```

    You can set your current device as the default device in all `toit device` commands with

    ```
    toit device use <name>
    ```

## Device firmware configuration

=== "Console"
The current firmware version installed on the device is displayed in the **Firmware** section. Click on the **Edit** icon to change it to another version from the drop down menu, then click **Save**. The proposed change is displayed both in the **Firmware** section and with an icon near the name of the device until it is actually installed the next time the device comes online.

=== "CLI"
To show the firmware version of your device, run

     ```
     toit device info
     ```

    Update the firmware on your device to the latest version with

    ```
    toit device update
    ```

    You can also downgrade the device with another firmware version with `toit device update [<older-firmware-version>]`, with the firmware version being formatted as `vx.x.x`.

## Device activation schedule

By default, the device is configured to be continuously online (Max offline = 0s). If your device operates on battery, it is recommended to change this configuration so that the device is online only when necessary to extend battery life.

=== "Console"

    In the **Configuration** tab for a given device, go to the section **Max offline** and edit the parameter with the new value (using hours, minutes and seconds) before clicking **Save**. The parameter will be changed next time the device comes online.

=== "CLI"

    Set the duration of how often you want your device to come online (once a day in this example) with

    ```
    toit device config max-offline 24h
    ```

This means that if you install an application measuring the temperature every hour while the `max-offline` is set to 24 hours, the application will run the program every hour, even as the device is offline. Only once a day the device will connect and offload all the data to the Toit console.

Note that a device can come online outside of the Max offline schedule when its storage capacity level reaches a predefined threshold, as explained in the Advanced configuration section below.

## Connections on device

You can change or add new connections on the device.

<Note type="warning">
The ESP32 cannot connect to 5GHz WiFi network.
</Note>

=== "Console"
Navigate to the **Configuration** tab, **Connections** section for a given device. Click on the **Edit** button to open the pop-up window in which you can add or delete a connection.

    When two or more connections are present, choose the order in which they should be used by moving the connections to use in priority above the others.

=== "CLI"
Beware that when using the CLI to configure the connection settings, you **need to type in all connections you want to use, in the order you want them to be used**.

    ```
    toit device config connection -c wifi:<SSID>:<MyWiFiPassword> -c cellular:<apn>
    ```

    Use

     `-c wifi:<SSID>:<MyWiFiPassword>`

    for setting a new WiFi connection, and use

    `-c cellular:<apn>`

    for setting up a cellular connection on your ESP32.

    Note that this command will **automatically delete all previously configured connections**.

### Unreachable device

If your ESP32 is misconfigured in any way, for example if it does not have valid WiFi connection settings, flash the ESP32 via a serial connection by connecting it with a USB cable to your computer, and run the `toit serial flash` command with the appropriate WiFi connection properties provided.

```
toit serial flash -p wifi.ssid=<SSID> -p wifi.password=<password>
```

The `flash` command flashes the ESP32 back to factory settings via the serial port without changing its device certificate or hardware ID.

## Advanced configuration

A device will attempt to come online based on the 'Max offline' parameter.
When the device is offline, the data (such as logs, metrics, and data generated by the apps running on the device) is stored on the device.
Reaching the full capacity of storage defined for this type of data means that the latest data will not be stored correctly.

To avoid this situation, it is possible to filter which type of logs and metrics are saved in the device.

In addition, a threshold of storage is set to trigger an online connection where data can be flushed from the device to the console.

See how you can minimize data storage and frequent triggered online connection in the  <Link to="../console/deviceconsole">devices management</Link> section.
